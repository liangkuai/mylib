# 负载因子 / 扩容机制

> **负载因子（load factor） = 哈希表中实际存储的键值对个数 / 哈希表数组的长度**

负载因子表示哈希表的填充程度。

根据负载因子的定义，**在哈希表数组长度固定的情况下**，随着存储的数据量增加，负载因子就会变大，说明表内空闲的位置越少。当装载因子大到一定程度之后，就会频繁的发生哈希冲突，哈希表的性能也会下降。所以**将负载因子控制在一个合理的范围内，或者直接设置成一个合理的值很重要。**

### 1. 那么负载因子的值应该设置为多少？

这需要在空间成本和时间成本之间权衡。如果内存空间很多而又对时间效率要求很高，可以降低负载因子的值；相反，如果内存空间紧张而对时间效率要求不高，可以增加负载因子的值，这个值可以大于1。

但是我们无法事先预估将要存储的数据量。根据负载因子的定义，**哈希表数组长度是我们唯一能够控制的会影响负载因子的变量**。所以确定哈希表的负载因子实际上就是确定哈希表数组的长度。


### 2. 哈希表数组的长度

如果哈希表数组很大，即使较差的哈希算法计算结果也会比较分散；如果哈希表数组数组很小，即使再好的哈希算法也会出现较多碰撞。但是哈希表内的数据可能会频繁的增删改，当哈希表的实际存储数据量超过阈值时（也就是实际的负载因子 > 预设的负载因子），哈希表数组的长度也得扩容。所以**哈希表必须有一个良好的扩容机制。**


## 扩容机制

针对数组的扩容，数据移动操作比较简单。但是，针对哈希表的扩容要复杂很多。因为哈希表的长度变了，数据的存储位置也会变，所以我们需要通过哈希函数重新计算每个数据的存储位置。
